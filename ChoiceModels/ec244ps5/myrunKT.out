Probit of mode choice, with alts: car alone, carpool, bus, train.
Checking the data and specifications.
Inputs have been checked and look fine.
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
     0          11           634.58                           798
     1          33          451.256    0.000574782            151  
     2          44           444.62              1            159  
     3          55          436.324              1           61.4  
     4          66          432.488              1            187  
     5          77          425.002              1           80.8  
     6          88          418.286              1           34.3  
     7          99          398.184              1           60.2  
     8         110          393.181              1           62.6  
     9         121          385.267              1           61.1  
    10         132          368.307              1           64.7  
    11         143          364.055              1           42.6  
    12         154          361.864              1           23.9  
    13         165          361.329              1             15  
    14         176          360.673              1           9.44  
    15         187          360.266              1           10.2  
    16         198          359.993              1           9.77  
    17         209          359.591              1           25.9  
    18         220          359.418              1           16.4  
    19         231          359.252              1           4.99  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
    20         242          359.035              1           17.3  
    21         253          358.613              1             39  
    22         275          358.379       0.354227           49.4  
    23         286          357.873              1           42.1  
    24         297          356.085              1           15.4  
    25         308          355.459              1           12.8  
    26         319          355.325              1           13.1  
    27         330          355.009              1           13.5  
    28         341          354.792              1           10.6  
    29         352          354.456              1           9.35  
    30         374          354.011       0.647877           14.3  
    31         385          353.941              1           6.15  
    32         396          353.884              1           6.77  
    33         407          353.622              1           14.1  
    34         418          353.392              1           30.6  
    35         440          353.035            0.5           37.6  
    36         462          352.816        0.44121           23.6  
    37         473          352.538              1           8.78  
    38         484          352.431              1           6.52  
    39         495          352.289              1           26.4  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
    40         506          352.159              1           5.67  
    41         517          352.079              1           8.61  
    42         528          351.993              1           11.9  
    43         539          351.933              1           6.18  
    44         550          351.888              1            4.1  
    45         561           351.87              1           3.71  
    46         572          351.825              1           6.36  
    47         583          351.781              1           6.96  
    48         594          351.745              1           4.22  
    49         605          351.733              1           3.27  
    50         616           351.73              1          0.586  
    51         627           351.73              1          0.583  
    52         638           351.73              1         0.0525  
    53         649           351.73              1        0.00643  
    54         660           351.73              1       0.000641  
Optimization terminated: relative infinity-norm of gradient less than options.TolFun.

Computing finite-difference Hessian using user-supplied objective function.
 
Estimation took 1.3177 minutes.
 
Convergence achieved.
Value of the log-likelihood function at convergence: -351.7302
Taking inverse of hessian for standard errors.
The value of grad*inv(hessian)*grad is: 2.2986e-009
 
ESTIMATION RESULTS
Coefficients 
              ---------------------------- 
                Est         SE      t-stat
cost          -0.2559     0.0366    -6.9857
time          -0.2890     0.0539    -5.3636
carpool       -1.8583     0.1283   -14.4867
bus           -1.0936     0.1743    -6.2725
train         -0.9234     0.1520    -6.0751
 
Choleski elements
              ---------------------------- 
                Est         SE      t-stat
    1.0000     0.4131     0.0623     6.6319
    2.0000     0.4513     0.1145     3.9419
    3.0000    -0.1197     0.0853    -1.4033
    4.0000     0.3623     0.0787     4.6009
    5.0000     0.4253     0.1020     4.1690
 
Covariance matrix for utility differences.
    1.0000    0.4131   -0.1197
    0.4131    0.3743    0.1140
   -0.1197    0.1140    0.3264

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
 
Predict shares at estimated coefficients.
Actual and predicted shares
     Alt      Actual    Predicted
    1.0000    0.4812    0.4767
    2.0000    0.0706    0.0788
    3.0000    0.1788    0.1779
    4.0000    0.2693    0.2667

Predicted probabilities are held in vector probs, which has size NALTxNCS.
