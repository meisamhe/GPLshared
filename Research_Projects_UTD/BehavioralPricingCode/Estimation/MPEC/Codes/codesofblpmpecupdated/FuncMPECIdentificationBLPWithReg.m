% To check the identification for model with regret
function [y] = FuncMPECIdentificationBLPWithReg(x)%,G
global P1 P2 Dur1 Dur2 availlambda gamma shares  km cost resultedShare; %outside_n
global vcm se_est betas variance
global pi1r bpdr alphapdr betardr cr

[J,T]=size(shares);
E= exp(1);


%X0=[pi1 bpd alphapd betard*c delta]

% parameters function [pi1 bp alphap betar*c delta]
pi1      =  x(1); %share of first segment 
bpd       =  x(2); %price coefficient difference heterogeneity coeff
alphapd   =  x(3); %high price regret difference heterogeneity coeff
tth1d    =   x(4); %stock out regret difference heterogeneity coeff multiplied to consumption utility
delta   = reshape(x(5:2*J+4)',[J 2]);
%delta = [ uij1s1 uij2s1];

dd_n=reshape(delta',J*2,1);

%-----------------------------------------Run OLS---------------------------------------------
%beta=[alpha c bp];
p = 5;
X1= [cost (0.5*Dur1+gamma.*Dur2).*ones(J,1) P1  availlambda.*(P1-P2) zeros(J,1)];
X2= [gamma.*availlambda.*cost gamma.*availlambda.*Dur2.*0.5 gamma.*availlambda.*P2 zeros(J,1) gamma.*(ones(J,1)-availlambda).*(0.5*Dur1+gamma.*Dur2)];

X=[X1 X2]';
Xn=reshape(X,p,J*2);
Xn=Xn'; %stack X's
Yn=dd_n;

betas=inv(Xn'*Xn)*Xn'*Yn;
errors=Yn-Xn*betas;
vcm=(errors'*errors)*inv(Xn'*Xn)/(2*J);
se_est=sqrt(diag(vcm));

% calculate variance

variance                 =    mean(errors.^2);

variance = max(variance,1e-320); %As a precaution

% define variables to use in likelihood
delta1 =      delta(:,1);
delta2 =      delta(:,2);
correspErrors = reshape(errors(:)',[J 2]);
xi1    =        correspErrors(:,1);
xi2    =        correspErrors(:,2);
alpha     =  betas(1);
c    =  betas(2);
bp    =  betas(3);
alphap = betas(4);
tth1   =  betas(5);
sigma = sqrt(variance);

% ------------------------------------------write the compelte likelihood-------------------------------
% to avoid Jacobian that is zero, which will create Log(0)= NaN; + ones(size(esh1,1)
uij1s1 =      delta(:,1);
uij2s1 =      delta(:,2);
uij1s2 =      delta(:,1)+bpd*P1(:) + alphapd.*availlambda(:).*(P1(:)-P2(:));    
uij2s2 =      delta(:,2)+gamma(:).*(availlambda(:).*(bpd*P2(:))+ tth1d*(ones(J,1)-availlambda(:)).*(0.5*Dur1(:)+gamma(:).*Dur2(:))); 

e1=exp(-[uij1s1 uij1s2]); e2=exp([uij2s1 uij2s2]-[uij1s1 uij1s2]);
s1    =     1./(1+e1+e2);
s2    =     e2./(1+e1+e2);
% condition to make sure I am not departing from feasible region
if (sum(sum(isinf(log(1+e1+e2))))>0)
    e1=exp([uij1s1 uij1s2]-[uij2s1 uij2s2]); e2=exp(-[uij2s1 uij2s2]);
    s1    =     e1./(1+e1+e2);
    s2    =     1./(1+e1+e2);
end;



s11   =     1-s1;
s1=max(s1,1e-160); %As a precaution
s11=max(s11,1e-160); %As a precaution
s21   =     1-s2;
s2=max(s2,1e-160);   %As a precaution
s21=max(s21,1e-160); %As a precaution
% for period 1 and period 2 respectively
Jacobian                 =    (((s1.*s11)*[pi1;1-pi1])).*(((s2.*s21)*[pi1;1-pi1])) -  (((s1.*s2)*[pi1;1-pi1])).^2;

LogJacobian              =    -sum(log(Jacobian(:)));

LogDemandShockLikelihood =    - 0.5*T*J*log(2*pi*variance) -   0.5*sum(errors.^2/variance);
logLiklihood               =    LogDemandShockLikelihood    +   LogJacobian  ;

% logJacobian = 0.5.*c.*Dur1 + 1.*c.*Dur2.*gamma + 1.*P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda - 0.5.*Dur1.*gamma.*tth1 - 1.*Dur2.*gamma.^2.*tth1 + 0.5.*Dur1.*gamma.*availlambda.*tth1 + 1.*Dur2.*gamma.^2.*availlambda.*tth1 - ...
%  4.*log(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%     E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)) - ...
%  4.*log(1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%     E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - ...
%  log(-(E.^(P1.*bp + 2.*P1.*alphap.*availlambda - 2.*P2.*alphap.*availlambda + P2.*bp.*gamma.*availlambda + cost.*(alpha + alpha.*gamma.*availlambda) + c.*(1.*Dur1 + (Dur2.*gamma.*(4 + availlambda))./2) + xi1 + xi2).*...
%      ((E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda + P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(-1 + pi1))./...
%         (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2).^2) + ...
%    E.^(0.5.*c.*Dur1 + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2).*...
%     ((E.^(cost.*alpha + P1.*bp + 2.*P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + 2.*(P1 - P2).*alphapd.*availlambda + xi1).*(-1 + pi1))./...
%       (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%         E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%           (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - (E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda).*(-1 + pi1))./...
%       (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%        E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%          (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - (E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1).*pi1)./...
%       (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%           (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2 + pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%        E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2))).*...
%     ((E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + 2.*P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d).*...
%        (-1 + pi1))./(1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%         E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%           (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - (E.^(P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(-1 + pi1))./...
%       (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%        E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%          (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - (E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2).*pi1)./...
%       (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%           (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2 + pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%        E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2))));
% 
% LLXi = 4.428168997512795 - sum((xi1.^2 + xi2.^2)./(2.*sigma.^2)) - log(sigma);
% 
% logLiklihood= LLXi+ sum(logJacobian);


% element1 = sum(((-2.*E.^(P1.*bp + 2.*P1.*alphap.*availlambda - 2.*P2.*alphap.*availlambda + P2.*bp.*gamma.*availlambda + cost.*(alpha + alpha.*gamma.*availlambda) + c.*(1.*Dur1 + (Dur2.*gamma.*(4 + availlambda))./2) + xi1 + xi2).*...
%     (-(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%           (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^(-2) + E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda + P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)./...
%       (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%         E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%           (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2).*((E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda + P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(-1 + pi1))./...
%       (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%         E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%           (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%         E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2) + ...
%    E.^(0.5.*c.*Dur1 + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2).*...
%     (-(E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)./...
%        (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%            (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2) + (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%        E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^(-1) + ...
%      E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + 2.*P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./...
%       (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%         E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%           (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - E.^(P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)./...
%       (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%        E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%          (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2))).*((E.^(cost.*alpha + P1.*bp + 2.*P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + 2.*(P1 - P2).*alphapd.*availlambda + xi1).*...
%        (-1 + pi1))./(1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%         E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%           (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - (E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda).*(-1 + pi1))./...
%       (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%        E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%          (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - (E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1).*pi1)./...
%       (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%           (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2 + pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%        E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2))) + ...
%    E.^(0.5.*c.*Dur1 + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2).*...
%     (-(E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1)./...
%        (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%            (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2) + (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%        E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^(-1) + ...
%      E.^(cost.*alpha + P1.*bp + 2.*P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + 2.*(P1 - P2).*alphapd.*availlambda + xi1)./...
%       (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%         E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%           (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda)./...
%       (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%        E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%          (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2))).*...
%     ((E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + 2.*P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d).*...
%        (-1 + pi1))./(1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%         E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%           (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - (E.^(P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(-1 + pi1))./...
%       (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%        E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%          (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - (E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2).*pi1)./...
%       (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%           (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2 + pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%        E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)))).*...
%   (0.5.*c.*Dur1 + 1.*c.*Dur2.*gamma + 1.*P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda - 0.5.*Dur1.*gamma.*tth1 - 1.*Dur2.*gamma.^2.*tth1 + 0.5.*Dur1.*gamma.*availlambda.*tth1 + 1.*Dur2.*gamma.^2.*availlambda.*tth1 - ...
%     4.*log(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%        E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)) - ...
%     4.*log(1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%        E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%          (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - ...
%     log(-(E.^(P1.*bp + 2.*P1.*alphap.*availlambda - 2.*P2.*alphap.*availlambda + P2.*bp.*gamma.*availlambda + cost.*(alpha + alpha.*gamma.*availlambda) + c.*(1.*Dur1 + (Dur2.*gamma.*(4 + availlambda))./2) + xi1 + xi2).*...
%         ((E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda + P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(-1 + pi1))./...
%            (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%              E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*...
%                  tth1d)./2)).^2 - pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%              E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2).^2) + ...
%       E.^(0.5.*c.*Dur1 + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2).*...
%        ((E.^(cost.*alpha + P1.*bp + 2.*P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + 2.*(P1 - P2).*alphapd.*availlambda + xi1).*(-1 + pi1))./...
%          (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%            E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%              (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - (E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda).*(-1 + pi1))./...
%          (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - (E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1).*pi1)./...
%          (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%              (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2 + pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2))).*...
%        ((E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + 2.*P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d).*...
%           (-1 + pi1))./(1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%            E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%              (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - (E.^(P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(-1 + pi1))./...
%          (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - (E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2).*pi1)./...
%          (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%              (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2 + pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2))))))./...
%  (-(E.^(P1.*bp + 2.*P1.*alphap.*availlambda - 2.*P2.*alphap.*availlambda + P2.*bp.*gamma.*availlambda + cost.*(alpha + alpha.*gamma.*availlambda) + c.*(1.*Dur1 + (Dur2.*gamma.*(4 + availlambda))./2) + xi1 + xi2).*...
%     ((E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda + P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(-1 + pi1))./...
%        (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%          E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%            (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%          E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2).^2) + ...
%   E.^(0.5.*c.*Dur1 + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2).*...
%    ((E.^(cost.*alpha + P1.*bp + 2.*P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + 2.*(P1 - P2).*alphapd.*availlambda + xi1).*(-1 + pi1))./...
%      (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%        E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^...
%       2 - (E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda).*(-1 + pi1))./(1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + ...
%         xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%         (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - (E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1).*pi1)./...
%      (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%          (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2 + pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%       E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2))).*...
%    ((E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + 2.*P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d).*...
%       (-1 + pi1))./(1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%        E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^...
%       2 - (E.^(P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(-1 + pi1))./...
%      (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%       E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%         (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - (E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2).*pi1)./...
%      (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%          (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2 + pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%       E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)))));
% 
% element2=sum(-(((-4.*(E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1).*P1 + ...
%       E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*...
%        P2.*gamma.*availlambda))./(1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%      E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - ...
%    (-2.*E.^(P1.*bp + 2.*P1.*alphap.*availlambda - 2.*P2.*alphap.*availlambda + P2.*bp.*gamma.*availlambda + cost.*(alpha + alpha.*gamma.*availlambda) + c.*(1.*Dur1 + (Dur2.*gamma.*(4 + availlambda))./2) + xi1 + xi2).*...
%       ((E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda + P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(-1 + pi1))./...
%         (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2).*...
%       ((E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda + P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(-1 + pi1).*(P1 + P2.*gamma.*availlambda))./...
%         (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - (2.*E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda + P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(-1 + pi1).*...
%          (E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1).*P1 + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%              (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*P2.*gamma.*availlambda))./(1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + ...
%             (P1 - P2).*alphapd.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^3) + E.^(0.5.*c.*Dur1 + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2).*...
%       ((E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + 2.*P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d).*...
%          (-1 + pi1))./(1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - (E.^(P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(-1 + pi1))./...
%         (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%          E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%            (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - (E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2).*pi1)./...
%         (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2 + pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%          E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2))).*...
%       ((2.*E.^(cost.*alpha + P1.*bp + 2.*P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + 2.*(P1 - P2).*alphapd.*availlambda + xi1).*P1.*(-1 + pi1))./...
%         (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - (E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda).*P1.*(-1 + pi1))./...
%         (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%          E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%            (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - (2.*E.^(cost.*alpha + P1.*bp + 2.*P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + 2.*(P1 - P2).*alphapd.*availlambda + xi1).*...
%          (-1 + pi1).*(E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1).*P1 + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%              (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*P2.*gamma.*availlambda))./(1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + ...
%             (P1 - P2).*alphapd.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^3 + (E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda).*(-1 + pi1).*...
%          (E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1).*P1 + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%              (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*P2.*gamma.*availlambda))./(1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + ...
%             (P1 - P2).*alphapd.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2) + E.^(0.5.*c.*Dur1 + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2).*...
%       ((E.^(cost.*alpha + P1.*bp + 2.*P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + 2.*(P1 - P2).*alphapd.*availlambda + xi1).*(-1 + pi1))./...
%         (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - (E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda).*(-1 + pi1))./...
%         (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%          E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%            (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - (E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1).*pi1)./...
%         (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2 + pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%          E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2))).*...
%       ((2.*E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + 2.*P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d).*...
%          P2.*gamma.*(-1 + pi1).*availlambda)./(1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - (E.^(P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*P2.*gamma.*(-1 + pi1).*availlambda)./...
%         (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%          E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%            (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - (2.*E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + 2.*P2.*bpd.*gamma.*availlambda + xi2 - ...
%            (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d).*(-1 + pi1).*...
%          (E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1).*P1 + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%              (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*P2.*gamma.*availlambda))./(1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + ...
%             (P1 - P2).*alphapd.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^3 + (E.^(P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(-1 + pi1).*...
%          (E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1).*P1 + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%              (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*P2.*gamma.*availlambda))./(1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + ...
%             (P1 - P2).*alphapd.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2))./...
%     (-(E.^(P1.*bp + 2.*P1.*alphap.*availlambda - 2.*P2.*alphap.*availlambda + P2.*bp.*gamma.*availlambda + cost.*(alpha + alpha.*gamma.*availlambda) + c.*(1.*Dur1 + (Dur2.*gamma.*(4 + availlambda))./2) + xi1 + xi2).*...
%        ((E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda + P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(-1 + pi1))./...
%           (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%             E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*...
%                 tth1d)./2)).^2 - pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%             E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2).^2) + ...
%      E.^(0.5.*c.*Dur1 + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2).*...
%       ((E.^(cost.*alpha + P1.*bp + 2.*P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + 2.*(P1 - P2).*alphapd.*availlambda + xi1).*(-1 + pi1))./...
%         (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - (E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda).*(-1 + pi1))./...
%         (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%          E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%            (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - (E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1).*pi1)./...
%         (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2 + pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%          E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2))).*...
%       ((E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + 2.*P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d).*...
%          (-1 + pi1))./(1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - (E.^(P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(-1 + pi1))./...
%         (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%          E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%            (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - (E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2).*pi1)./...
%         (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2 + pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%          E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2))))).*...
%   (0.5.*c.*Dur1 + 1.*c.*Dur2.*gamma + 1.*P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda - 0.5.*Dur1.*gamma.*tth1 - 1.*Dur2.*gamma.^2.*tth1 + 0.5.*Dur1.*gamma.*availlambda.*tth1 + 1.*Dur2.*gamma.^2.*availlambda.*tth1 - ...
%     4.*log(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%        E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)) - ...
%     4.*log(1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%        E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%          (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - ...
%     log(-(E.^(P1.*bp + 2.*P1.*alphap.*availlambda - 2.*P2.*alphap.*availlambda + P2.*bp.*gamma.*availlambda + cost.*(alpha + alpha.*gamma.*availlambda) + c.*(1.*Dur1 + (Dur2.*gamma.*(4 + availlambda))./2) + xi1 + xi2).*...
%         ((E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda + P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(-1 + pi1))./...
%            (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%              E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*...
%                  tth1d)./2)).^2 - pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%              E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2).^2) + ...
%       E.^(0.5.*c.*Dur1 + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2).*...
%        ((E.^(cost.*alpha + P1.*bp + 2.*P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + 2.*(P1 - P2).*alphapd.*availlambda + xi1).*(-1 + pi1))./...
%          (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%            E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%              (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - (E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda).*(-1 + pi1))./...
%          (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - (E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1).*pi1)./...
%          (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%              (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2 + pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) +... 
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2))).*...
%        ((E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + 2.*P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d).*...
%           (-1 + pi1))./(1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%            E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%              (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - (E.^(P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(-1 + pi1))./...
%          (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - (E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2).*pi1)./...
%          (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%              (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2 + pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)))))));
% element3 =sum(-(((-4.*E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1).*(P1 - P2).*availlambda)./...
%     (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%      E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - ...
%    (-2.*E.^(P1.*bp + 2.*P1.*alphap.*availlambda - 2.*P2.*alphap.*availlambda + P2.*bp.*gamma.*availlambda + cost.*(alpha + alpha.*gamma.*availlambda) + c.*(1.*Dur1 + (Dur2.*gamma.*(4 + availlambda))./2) + xi1 + xi2).*...
%       ((E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda + P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(-1 + pi1))./...
%         (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2).*...
%       ((-2.*E.^(cost.*alpha + P1.*bp + 2.*P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + 2.*(P1 - P2).*alphapd.*availlambda + P2.*bpd.*gamma.*availlambda + xi1 - ...
%            (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(P1 - P2).*(-1 + pi1).*availlambda)./...
%         (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^3 + (E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda + P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(P1 - P2).*...
%          (-1 + pi1).*availlambda)./(1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2) + E.^(0.5.*c.*Dur1 + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2).*...
%       ((E.^(cost.*alpha + P1.*bp + 2.*P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + 2.*(P1 - P2).*alphapd.*availlambda + xi1).*(-1 + pi1))./...
%         (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - (E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda).*(-1 + pi1))./...
%         (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%          E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%            (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - (E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1).*pi1)./...
%         (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2 + pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%          E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2))).*...
%       ((-2.*E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + (c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + ...
%            2.*P2.*bpd.*gamma.*availlambda + xi1 + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d).*(P1 - P2).*(-1 + pi1).*availlambda)./...
%         (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^3 + (E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + ...
%            P2.*bpd.*gamma.*availlambda + xi1 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(P1 - P2).*(-1 + pi1).*availlambda)./...
%         (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2) + E.^(0.5.*c.*Dur1 + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2).*...
%       ((E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + 2.*P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d).*...
%          (-1 + pi1))./(1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - (E.^(P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(-1 + pi1))./...
%         (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%          E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%            (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - (E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2).*pi1)./...
%         (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2 + pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%          E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2))).*...
%       ((-2.*E.^(2.*cost.*alpha + 2.*P1.*bp + 3.*P1.*bpd + 2.*c.*(0.5.*Dur1 + Dur2.*gamma) + 2.*(P1 - P2).*alphap.*availlambda + 3.*(P1 - P2).*alphapd.*availlambda + 2.*xi1).*(P1 - P2).*(-1 + pi1).*availlambda)./...
%         (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^3 + (3.*E.^(cost.*alpha + P1.*bp + 2.*P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + 2.*(P1 - P2).*alphapd.*availlambda + ...
%            xi1).*(P1 - P2).*(-1 + pi1).*availlambda)./(1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - (E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda).*(P1 - P2).*(-1 + pi1).*availlambda)./...
%         (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%          E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%            (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2))))./...
%     (-(E.^(P1.*bp + 2.*P1.*alphap.*availlambda - 2.*P2.*alphap.*availlambda + P2.*bp.*gamma.*availlambda + cost.*(alpha + alpha.*gamma.*availlambda) + c.*(1.*Dur1 + (Dur2.*gamma.*(4 + availlambda))./2) + xi1 + xi2).*...
%        ((E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda + P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(-1 + pi1))./...
%           (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%             E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*...
%                 tth1d)./2)).^2 - pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%             E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2).^2) + ...
%      E.^(0.5.*c.*Dur1 + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2).*...
%       ((E.^(cost.*alpha + P1.*bp + 2.*P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + 2.*(P1 - P2).*alphapd.*availlambda + xi1).*(-1 + pi1))./...
%         (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - (E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda).*(-1 + pi1))./...
%         (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%          E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%            (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - (E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1).*pi1)./...
%         (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2 + pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%          E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2))).*...
%       ((E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + 2.*P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d).*...
%          (-1 + pi1))./(1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - (E.^(P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(-1 + pi1))./...
%         (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%          E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%            (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - (E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2).*pi1)./...
%         (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2 + pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%          E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2))))).*...
%   (0.5.*c.*Dur1 + 1.*c.*Dur2.*gamma + 1.*P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda - 0.5.*Dur1.*gamma.*tth1 - 1.*Dur2.*gamma.^2.*tth1 + 0.5.*Dur1.*gamma.*availlambda.*tth1 + 1.*Dur2.*gamma.^2.*availlambda.*tth1 - ...
%     4.*log(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%        E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)) - ...
%     4.*log(1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%        E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%          (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - ...
%     log(-(E.^(P1.*bp + 2.*P1.*alphap.*availlambda - 2.*P2.*alphap.*availlambda + P2.*bp.*gamma.*availlambda + cost.*(alpha + alpha.*gamma.*availlambda) + c.*(1.*Dur1 + (Dur2.*gamma.*(4 + availlambda))./2) + xi1 + xi2).*...
%         ((E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda + P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(-1 + pi1))./...
%            (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%              E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*...
%                  tth1d)./2)).^2 - pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%              E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2).^2) + ...
%       E.^(0.5.*c.*Dur1 + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2).*...
%        ((E.^(cost.*alpha + P1.*bp + 2.*P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + 2.*(P1 - P2).*alphapd.*availlambda + xi1).*(-1 + pi1))./...
%          (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%            E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%              (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - (E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda).*(-1 + pi1))./...
%          (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - (E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1).*pi1)./...
%          (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%              (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2 + pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2))).*...
%        ((E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + 2.*P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d).*...
%           (-1 + pi1))./(1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%            E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%              (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - (E.^(P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(-1 + pi1))./...
%          (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - (E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2).*pi1)./...
%          (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%              (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2 + pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)))))));
% element4 = sum(-((-((-2.*E.^(P1.*bp + 2.*P1.*alphap.*availlambda - 2.*P2.*alphap.*availlambda + P2.*bp.*gamma.*availlambda + cost.*(alpha + alpha.*gamma.*availlambda) + c.*(1.*Dur1 + (Dur2.*gamma.*(4 + availlambda))./2) + xi1 + xi2).*...
%        ((E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda + P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(-1 + pi1))./...
%          (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%            E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%              (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%            E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2).*...
%        ((E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda + (c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + 2.*P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 -... 
%             gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d).*gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + pi1).*(-1 + availlambda))./...
%          (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%            E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%              (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^3 - (E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda + P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*gamma.*...
%           (Dur1 + 2.*Dur2.*gamma).*(-1 + pi1).*(-1 + availlambda))./(2.*(1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%             E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*...
%                 tth1d)./2)).^2)) + E.^(0.5.*c.*Dur1 + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2).*...
%        ((E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + 2.*P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d).*...
%           (-1 + pi1))./(1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%            E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%              (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - (E.^(P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(-1 + pi1))./...
%          (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - (E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2).*pi1)./...
%          (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%              (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2 + pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2))).*......
%        ((E.^(cost.*alpha + P1.*bp + 2.*P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + 2.*(P1 - P2).*alphapd.*availlambda + (c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + ...
%             P2.*bpd.*gamma.*availlambda + xi1 + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + pi1).*(-1 + availlambda))./...
%          (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%            E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%              (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^3 - (E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda + (c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + ...
%             xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + pi1).*(-1 + availlambda))./...
%          (2.*(1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%             E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*...
%                 tth1d)./2)).^2)) + E.^(0.5.*c.*Dur1 + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2).*...
%        ((E.^(cost.*alpha + P1.*bp + 2.*P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + 2.*(P1 - P2).*alphapd.*availlambda + xi1).*(-1 + pi1))./...
%          (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%            E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%              (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - (E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda).*(-1 + pi1))./...
%          (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - (E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1).*pi1)./...
%          (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%              (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2 + pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2))).*...
%        ((E.^(c.*Dur2.*gamma.*availlambda + 2.*cost.*alpha.*gamma.*availlambda + 2.*P2.*bp.*gamma.*availlambda + 3.*P2.*bpd.*gamma.*availlambda + 2.*xi2 - gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1 - ...
%             (3.*gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + pi1).*(-1 + availlambda))./...
%          (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%            E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%              (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^3 - (3.*E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + 2.*P2.*bpd.*gamma.*availlambda + xi2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d).*gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + pi1).*(-1 + availlambda))./...
%          (2.*(1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%             E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*...
%                 tth1d)./2)).^2) + (E.^(P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + pi1).*(-1 + availlambda))./...
%          (2.*(1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%            E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%              (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)))))./...
%      (-(E.^(P1.*bp + 2.*P1.*alphap.*availlambda - 2.*P2.*alphap.*availlambda + P2.*bp.*gamma.*availlambda + cost.*(alpha + alpha.*gamma.*availlambda) + c.*(1.*Dur1 + (Dur2.*gamma.*(4 + availlambda))./2) + xi1 + xi2).*...
%         ((E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda + P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(-1 + pi1))./...
%            (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%              E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*...
%                  tth1d)./2)).^2 - pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%              E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2).^2) + ...
%       E.^(0.5.*c.*Dur1 + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2).*...
%        ((E.^(cost.*alpha + P1.*bp + 2.*P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + 2.*(P1 - P2).*alphapd.*availlambda + xi1).*(-1 + pi1))./...
%          (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%            E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%              (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - (E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda).*(-1 + pi1))./...
%          (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - (E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1).*pi1)./...
%          (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%              (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2 + pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2))).*...
%        ((E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + 2.*P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d).*...
%           (-1 + pi1))./(1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%            E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%              (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - (E.^(P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(-1 + pi1))./...
%          (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - (E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2).*pi1)./...
%          (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%              (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2 + pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2))))) + ...
%    (2.*E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*...
%      gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda))./(1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%      E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2))).*...
%  (0.5.*c.*Dur1 + 1.*c.*Dur2.*gamma + 1.*P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda - 0.5.*Dur1.*gamma.*tth1 - 1.*Dur2.*gamma.^2.*tth1 + 0.5.*Dur1.*gamma.*availlambda.*tth1 + 1.*Dur2.*gamma.^2.*availlambda.*tth1 - ...
%     4.*log(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%        E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)) -... 
%     4.*log(1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%        E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%          (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - ...
%     log(-(E.^(P1.*bp + 2.*P1.*alphap.*availlambda - 2.*P2.*alphap.*availlambda + P2.*bp.*gamma.*availlambda + cost.*(alpha + alpha.*gamma.*availlambda) + c.*(1.*Dur1 + (Dur2.*gamma.*(4 + availlambda))./2) + xi1 + xi2).*...
%         ((E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda + P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(-1 + pi1))./...
%            (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%              E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*...
%                  tth1d)./2)).^2 - pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%              E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2).^2) + ...
%       E.^(0.5.*c.*Dur1 + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2).*...
%        ((E.^(cost.*alpha + P1.*bp + 2.*P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + 2.*(P1 - P2).*alphapd.*availlambda + xi1).*(-1 + pi1))./...
%          (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%            E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%              (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - (E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda).*(-1 + pi1))./...
%          (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - (E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1).*pi1)./...
%          (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%              (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2 + pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2))).*...
%        ((E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + 2.*P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d).*...
%           (-1 + pi1))./(1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%            E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%              (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - (E.^(P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(-1 + pi1))./...
%          (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - (E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2).*pi1)./...
%          (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%              (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2 + pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)))))));
% element5 = delta1./sigma.^2 - ((-4.*E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1))./...
%     (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%      E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)) - ...
%    (4.*E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1))./...
%     (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%      E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - ...
%    (-2.*E.^(P1.*bp + 2.*P1.*alphap.*availlambda - 2.*P2.*alphap.*availlambda + P2.*bp.*gamma.*availlambda + cost.*(alpha + alpha.*gamma.*availlambda) + c.*(1.*Dur1 + (Dur2.*gamma.*(4 + availlambda))./2) + xi1 + xi2).*...
%       ((-2.*E.^(cost.*alpha + P1.*bp + 2.*P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + 2.*(P1 - P2).*alphapd.*availlambda + P2.*bpd.*gamma.*availlambda + xi1 - ...
%            (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(-1 + pi1))./(1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + ...
%             (P1 - P2).*alphapd.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^3 + (2.*E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1).*pi1)./...
%         (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^3).*((E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda + P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(-1 + pi1))./...
%         (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2) - ...
%      E.^(P1.*bp + 2.*P1.*alphap.*availlambda - 2.*P2.*alphap.*availlambda + P2.*bp.*gamma.*availlambda + cost.*(alpha + alpha.*gamma.*availlambda) + c.*(1.*Dur1 + (Dur2.*gamma.*(4 + availlambda))./2) + xi1 + xi2).*...
%       ((E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda + P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(-1 + pi1))./...
%          (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%            E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%              (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%            E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2).^2 +... 
%      E.^(0.5.*c.*Dur1 + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2).*...
%       ((-2.*E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + (c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + ...
%            2.*P2.*bpd.*gamma.*availlambda + xi1 + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d).*(-1 + pi1))./...
%         (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^3 + (E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + ...
%            P2.*bpd.*gamma.*availlambda + xi1 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(-1 + pi1))./...
%         (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 + (2.*E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + (c.*Dur2.*gamma.*availlambda)./2 + ...
%            cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi1 + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2).*pi1)./...
%         (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^3 - (E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1).*pi1)./...
%         (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2).*((E.^(cost.*alpha + P1.*bp + 2.*P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + 2.*(P1 - P2).*alphapd.*availlambda + xi1).*...
%          (-1 + pi1))./(1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - (E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda).*(-1 + pi1))./...
%         (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%          E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%            (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - (E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1).*pi1)./...
%         (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2 + pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%          E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2))) + ...
%      E.^(0.5.*c.*Dur1 + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2).*...
%       ((-2.*E.^(2.*cost.*alpha + 2.*P1.*bp + 3.*P1.*bpd + 2.*c.*(0.5.*Dur1 + Dur2.*gamma) + 2.*(P1 - P2).*alphap.*availlambda + 3.*(P1 - P2).*alphapd.*availlambda + 2.*xi1).*(-1 + pi1))./...
%         (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^3 + (2.*E.^(cost.*alpha + P1.*bp + 2.*P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + 2.*(P1 - P2).*alphapd.*availlambda + ...
%            xi1).*(-1 + pi1))./(1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 + (2.*E.^(1.*c.*Dur1 + 2.*cost.*alpha + 2.*P1.*bp + 2.*c.*Dur2.*gamma + 2.*P1.*alphap.*availlambda - 2..*P2.*alphap.*availlambda + 2.*xi1).*pi1)./...
%         (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^3 - (2.*E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1).*pi1)./...
%         (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2).*...
%       ((E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + 2.*P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d).*...
%          (-1 + pi1))./(1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - (E.^(P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(-1 + pi1))./...
%         (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%          E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%            (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - (E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2).*pi1)./...
%         (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2 + pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%          E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2))))./...
%     (-(E.^(P1.*bp + 2.*P1.*alphap.*availlambda - 2.*P2.*alphap.*availlambda + P2.*bp.*gamma.*availlambda + cost.*(alpha + alpha.*gamma.*availlambda) + c.*(1.*Dur1 + (Dur2.*gamma.*(4 + availlambda))./2) + xi1 + xi2).*...
%        ((E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda + P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(-1 + pi1))./...
%           (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%             E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*...
%                 tth1d)./2)).^2 - pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%             E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2).^2) + ...
%      E.^(0.5.*c.*Dur1 + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2).*...
%       ((E.^(cost.*alpha + P1.*bp + 2.*P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + 2.*(P1 - P2).*alphapd.*availlambda + xi1).*(-1 + pi1))./...
%         (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - (E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda).*(-1 + pi1))./...
%         (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%          E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%            (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - (E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1).*pi1)./...
%         (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2 + pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%          E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2))).*...
%       ((E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + 2.*P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d).*...
%          (-1 + pi1))./(1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - (E.^(P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(-1 + pi1))./...
%         (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%          E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%            (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - (E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2).*pi1)./...
%         (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2 + pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%          E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2))))).*...
%   (0.5.*c.*Dur1 + 1.*c.*Dur2.*gamma + 1.*P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda - 0.5.*Dur1.*gamma.*tth1 - 1.*Dur2.*gamma.^2.*tth1 + 0.5.*Dur1.*gamma.*availlambda.*tth1 + 1.*Dur2.*gamma.^2.*availlambda.*tth1 - ...
%     4.*log(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%        E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)) - ...
%     4.*log(1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%        E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%          (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - ...
%     log(-(E.^(P1.*bp + 2.*P1.*alphap.*availlambda - 2.*P2.*alphap.*availlambda + P2.*bp.*gamma.*availlambda + cost.*(alpha + alpha.*gamma.*availlambda) + c.*(1.*Dur1 + (Dur2.*gamma.*(4 + availlambda))./2) + xi1 + xi2).*...
%         ((E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda + P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(-1 + pi1))./...
%            (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%              E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*...
%                  tth1d)./2)).^2 - pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%              E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2).^2) + ...
%       E.^(0.5.*c.*Dur1 + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2).*...
%        ((E.^(cost.*alpha + P1.*bp + 2.*P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + 2.*(P1 - P2).*alphapd.*availlambda + xi1).*(-1 + pi1))./...
%          (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%            E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%              (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - (E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda).*(-1 + pi1))./...
%          (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - (E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1).*pi1)./...
%          (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%              (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2 + pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2))).*...
%        ((E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + 2.*P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d).*...
%           (-1 + pi1))./(1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%            E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%              (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - (E.^(P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(-1 + pi1))./...
%          (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - (E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2).*pi1)./...
%          (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%              (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2 + pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)))));
%         
% element6=delta2./sigma.^2 - ((-4.*E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2))./...
%     (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%      E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)) - ...
%    (4.*E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2))./...
%     (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%      E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - ...
%    (-2.*E.^(P1.*bp + 2.*P1.*alphap.*availlambda - 2.*P2.*alphap.*availlambda + P2.*bp.*gamma.*availlambda + cost.*(alpha + alpha.*gamma.*availlambda) + c.*(1.*Dur1 + (Dur2.*gamma.*(4 + availlambda))./2) + xi1 + xi2).*...
%       ((-2.*E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda + (c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + 2.*P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%            gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d).*(-1 + pi1))./(1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + ...
%             xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^3 + (2.*E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2).*pi1)./...
%         (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^3).*((E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda + P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(-1 + pi1))./...
%         (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2) - ...
%      E.^(P1.*bp + 2.*P1.*alphap.*availlambda - 2.*P2.*alphap.*availlambda + P2.*bp.*gamma.*availlambda + cost.*(alpha + alpha.*gamma.*availlambda) + c.*(1.*Dur1 + (Dur2.*gamma.*(4 + availlambda))./2) + xi1 + xi2).*...
%       ((E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda + P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(-1 + pi1))./...
%          (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%            E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%              (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%            E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2).^2 + ...
%      E.^(0.5.*c.*Dur1 + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2).*...
%       ((-2.*E.^(c.*Dur2.*gamma.*availlambda + 2.*cost.*alpha.*gamma.*availlambda + 2.*P2.*bp.*gamma.*availlambda + 3.*P2.*bpd.*gamma.*availlambda + 2.*xi2 - gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1 - ...
%            (3.*gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(-1 + pi1))./(1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + ...
%             (P1 - P2).*alphapd.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^3 + (2.*E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + 2.*P2.*bpd.*gamma.*availlambda + xi2 - ...
%            (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d).*(-1 + pi1))./...
%         (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 + (2.*E.^(c.*Dur2.*gamma.*availlambda + 2.*cost.*alpha.*gamma.*availlambda + 2.*P2.*bp.*gamma.*availlambda + 2.*xi2 - gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1).*pi1)./...
%         (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^3 - (2.*E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2).*pi1)./...
%         (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 -... 
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2).*((E.^(cost.*alpha + P1.*bp + 2.*P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + 2.*(P1 - P2).*alphapd.*availlambda + xi1).*...
%          (-1 + pi1))./(1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - (E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda).*(-1 + pi1))./...
%         (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%          E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%            (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - (E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1).*pi1)./...
%         (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2 + pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%          E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2))) + ...
%      E.^(0.5.*c.*Dur1 + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2).*...
%       ((-2.*E.^(cost.*alpha + P1.*bp + 2.*P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + 2.*(P1 - P2).*alphapd.*availlambda + (c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + ...
%            P2.*bpd.*gamma.*availlambda + xi1 + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(-1 + pi1))./...
%         (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^3 + (E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda + (c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + ...
%            xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(-1 + pi1))./...
%         (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 + (2.*E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + (c.*Dur2.*gamma.*availlambda)./2 + ...
%            cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi1 + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2).*pi1)./...
%         (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^3 - (E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2).*pi1)./...
%         (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2).*...
%       ((E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + 2.*P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d).*...
%          (-1 + pi1))./(1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - (E.^(P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(-1 + pi1))./...
%         (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%          E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%            (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - (E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2).*pi1)./...
%         (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2 + pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%          E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2))))./...
%     (-(E.^(P1.*bp + 2.*P1.*alphap.*availlambda - 2.*P2.*alphap.*availlambda + P2.*bp.*gamma.*availlambda + cost.*(alpha + alpha.*gamma.*availlambda) + c.*(1.*Dur1 + (Dur2.*gamma.*(4 + availlambda))./2) + xi1 + xi2).*...
%        ((E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda + P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(-1 + pi1))./...
%           (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%             E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*...
%                 tth1d)./2)).^2 - pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%             E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2).^2) + ...
%      E.^(0.5.*c.*Dur1 + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2).*...
%       ((E.^(cost.*alpha + P1.*bp + 2.*P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + 2.*(P1 - P2).*alphapd.*availlambda + xi1).*(-1 + pi1))./...
%         (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - (E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda).*(-1 + pi1))./...
%         (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%          E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%            (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - (E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1).*pi1)./...
%         (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2 + pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%          E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2))).*...
%       ((E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + 2.*P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d).*...
%          (-1 + pi1))./(1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - (E.^(P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(-1 + pi1))./...
%         (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%          E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%            (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - (E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2).*pi1)./...
%         (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2 + pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%          E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2))))).*...
%   (0.5.*c.*Dur1 + 1.*c.*Dur2.*gamma + 1.*P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda - 0.5.*Dur1.*gamma.*tth1 - 1.*Dur2.*gamma.^2.*tth1 + 0.5.*Dur1.*gamma.*availlambda.*tth1 + 1.*Dur2.*gamma.^2.*availlambda.*tth1 - ...
%     4.*log(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%        E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)) - ...
%     4.*log(1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%        E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%          (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - ...
%     log(-(E.^(P1.*bp + 2.*P1.*alphap.*availlambda - 2.*P2.*alphap.*availlambda + P2.*bp.*gamma.*availlambda + cost.*(alpha + alpha.*gamma.*availlambda) + c.*(1.*Dur1 + (Dur2.*gamma.*(4 + availlambda))./2) + xi1 + xi2).*...
%         ((E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda + P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(-1 + pi1))./...
%            (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%              E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*...
%                  tth1d)./2)).^2 - pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%              E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2).^2) + ...
%       E.^(0.5.*c.*Dur1 + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2).*...
%        ((E.^(cost.*alpha + P1.*bp + 2.*P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + 2.*(P1 - P2).*alphapd.*availlambda + xi1).*(-1 + pi1))./...
%          (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%            E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%              (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - (E.^(P1.*bpd + (P1 - P2).*alphapd.*availlambda).*(-1 + pi1))./...
%          (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%             (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)) - (E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1).*pi1)./...
%          (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%              (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2 + pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2))).*...
%        ((E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + 2.*P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d).*...
%           (-1 + pi1))./(1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%            E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%              (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2)).^2 - (E.^(P2.*bpd.*gamma.*availlambda - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1d)./2).*(-1 + pi1))./...
%          (1 + E.^(cost.*alpha + P1.*bp + P1.*bpd + c.*(0.5.*Dur1 + Dur2.*gamma) + (P1 - P2).*alphap.*availlambda + (P1 - P2).*alphapd.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + P2.*bpd.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2 - ...
%          (1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - ...
%              (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2)).^2 + pi1./(1 + E.^(0.5.*c.*Dur1 + cost.*alpha + P1.*bp + c.*Dur2.*gamma + P1.*alphap.*availlambda - 1.*P2.*alphap.*availlambda + xi1) + ...
%           E.^((c.*Dur2.*gamma.*availlambda)./2 + cost.*alpha.*gamma.*availlambda + P2.*bp.*gamma.*availlambda + xi2 - (gamma.*(Dur1 + 2.*Dur2.*gamma).*(-1 + availlambda).*tth1)./2))))));
%       
% 
% G = [element1, element2, element3, element4, element5', element6']';
% disp('size of G is:')
% size(G)

if (variance==0)
    error('variance is zero!!!');
end;

y                        =    - logLiklihood ;
 
%disp('Current Likelihood is:')
%-y





